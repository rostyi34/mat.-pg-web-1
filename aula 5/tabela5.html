<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tabela - Notas dos Alunos</title>
  <link rel="stylesheet" href="aula3.css">
</head>
<body>

  <h2>Notas dos Alunos</h2>

  <table id="tabelaNotas">
    <tr>
      <th rowspan="2">Aluno</th>
      <th colspan="3">Semestre 1</th>
      <th colspan="3">Semestre 2</th>
      <th colspan="3">Semestre 3</th>
    </tr>
    <tr>
      <th>Nota 1</th>
      <th>Nota 2</th>
      <th>Nota 3</th>
      <th>Nota 1</th>
      <th>Nota 2</th>
      <th>Nota 3</th>
      <th>Nota 1</th>
      <th>Nota 2</th>
      <th>Nota 3</th>
    </tr>
    <tr>
      <td>João</td>
      <td>10</td><td>8</td><td>9</td>
      <td>6</td><td>8.7</td><td>10</td>
      <td>6</td><td>7</td><td>9</td>
    </tr>
    <tr>
      <td>Maria</td>
      <td>0</td><td></td><td></td>
      <td></td><td></td><td></td>
      <td></td><td></td><td></td>
    </tr>
    <tr>
      <td>José</td>
      <td></td><td></td><td></td>
      <td></td><td></td><td></td>
      <td></td><td></td><td></td>
    </tr>
    <tr>
      <td>Paulo</td>
      <td></td><td></td><td></td>
      <td></td><td></td><td></td>
      <td></td><td></td><td></td>
    </tr>
    <tr>
      <td>Miguel</td>
      <td><input type="number" size="2"></td><td></td><td></td>
      <td></td><td></td><td></td>
      <td></td><td></td><td></td>
    </tr>
    <tr>
      <td>Julia</td>
      <td></td><td></td><td></td>
      <td></td><td></td><td></td>
      <td></td><td></td><td></td>
    </tr>
  </table>

  <br>
  <button onclick="adicionarLinha()">Adicionar Linha de Médias</button>
  <button onclick="adicionarColuna()">Adicionar Coluna de Médias</button>

  <script>
    function adicionarLinha() {
      let tabela = document.getElementById("tabelaNotas");
      let linhas = tabela.rows;
      let colunas = linhas[0].cells.length;

      let novaLinha = tabela.insertRow(-1);
      novaLinha.insertCell(0).innerHTML = "<b>Média Notas</b>";

      for (let c = 1; c < colunas; c++) {
        let soma = 0, qtd = 0;
        for (let l = 2; l < linhas.length - 1; l++) {
          let valor = linhas[l].cells[c].innerText || linhas[l].cells[c].querySelector("input")?.value;
          if (valor) {
            soma += parseFloat(valor);
            qtd++;
          }
        }
        novaLinha.insertCell(c).innerText = qtd ? (soma / qtd).toFixed(1) : "-";
      }
    }

    function adicionarColuna() {
      let tabela = document.getElementById("tabelaNotas");
      let linhas = tabela.rows;

      linhas[0].insertCell(-1).outerHTML = "<th rowspan='2'>Média Aluno</th>";

      for (let l = 2; l < linhas.length; l++) {
        let soma = 0, qtd = 0;
        for (let c = 1; c < linhas[l].cells.length; c++) {
          let valor = linhas[l].cells[c].innerText || linhas[l].cells[c].querySelector("input")?.value;
          if (valor) {
            soma += parseFloat(valor);
            qtd++;
          }
        }
        linhas[l].insertCell(-1).innerText = qtd ? (soma / qtd).toFixed(1) : "-";
      }
    }
  </script>

</body>
</html>
